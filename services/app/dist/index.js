(()=>{"use strict";var e={237:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(965)),s=n(231);class r extends o.default{list(e){return{icons:(0,s.toCamelCaseObject)(e)}}}t.default=r},206:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function u(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,u)}a((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(n(237));t.default=()=>{const e=new s.default;return{list:(t,n,o)=>{i(void 0,void 0,void 0,(function*(){n.status(200).send(e.list([{id:1,category:"11",image_path:"niku.png"},{id:2,category:"22",image_path:"yasai.png"}]))})).catch(o)}}}},335:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(206));t.default=e=>{const t=e.Router(),n=(0,o.default)();return t.route("/icons").get(n.list),t}},686:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(965));class s extends o.default{add(e){return{id:e.id,name:e.name}}}t.default=s},482:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function u(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,u)}a((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(n(406)),r=o(n(686)),u=o(n(184));t.default=()=>{const e=new r.default,t=(0,u.default)();return{add:(n,o,r)=>{i(void 0,void 0,void 0,(function*(){const i=new s.default(n),r=yield t.insert(i);o.status(200).send(e.add(r))})).catch(r)}}}},406:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){const{name:t}=e.body;this._name=t,this._user_id=e.user.id}get name(){return this._name}get userId(){return this._user_id}}},524:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,n){this.id=e,this.name=t,this.userId=n}}},516:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function u(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,u)}a((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PlacesDB=void 0;const s=n(492),r=o(n(972));!function(e){e.select=e=>i(this,void 0,void 0,(function*(){return yield s.Places.findAll({where:e})})),e.update=(e,t)=>i(this,void 0,void 0,(function*(){let n=yield s.Places.findAll({where:e});if(!n)throw new r.default("Data Not Found",404);if(n.length>1)throw new r.default("Some Data Found",404);const i=n[0];return t.name&&(i.name=t.name),t.user_id&&(i.user_id=t.user_id),yield i.save()})),e.insert=(e,t)=>i(this,void 0,void 0,(function*(){return yield s.Places.create({name:e,user_id:t})})),e.destroy=e=>i(this,void 0,void 0,(function*(){const t=yield s.Places.findAll({where:e});if(!t)throw new r.default("Data Not Found",404);if(t.length>1)throw new r.default("Some Data Found",404);t[0].destroy().then((()=>!0)).catch((()=>{throw new r.default("Failed Delete Data",404)}))}))}(t.PlacesDB||(t.PlacesDB={}))},937:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(267)),s=i(n(482));t.default=e=>{const t=e.Router(),n=(0,s.default)();return t.route("/:userId/places").post(o.default,n.add),t}},184:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function u(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,u)}a((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(n(524)),r=n(516);t.default=()=>({insert:e=>i(void 0,void 0,void 0,(function*(){const t=yield r.PlacesDB.insert(e.name,e.userId);return new s.default(t.id,t.name,t.user_id)})),list:()=>i(void 0,void 0,void 0,(function*(){})),update:()=>i(void 0,void 0,void 0,(function*(){})),remove:()=>i(void 0,void 0,void 0,(function*(){}))})},523:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(965));class s extends o.default{signup(e){return{id:e.id,email:e.email}}login(e,t){return{id:e.id,email:e.email,token:t}}}t.default=s},534:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function u(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,u)}a((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(785),r=o(n(122)),u=o(n(20)),a=o(n(523)),l=o(n(540));t.default=()=>{const e=new a.default,t=(0,l.default)();return{signup:(n,o,s)=>{i(void 0,void 0,void 0,(function*(){const i=new u.default(n),s=yield t.signup(i);o.status(200).send(e.signup(s))})).catch(s)},login:(n,o,u)=>{i(void 0,void 0,void 0,(function*(){const i=new r.default(n),u=yield t.login(i),a={id:u.id,email:u.email},l=(0,s.signToken)(a);o.status(200).send(e.login(u,l))})).catch(u)}}}},122:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(96);t.default=class{constructor(e){const{email:t,password:n}=e.body;this._email=t,this._password=n}get email(){return this._email}get password(){return this._password}comparePassword(e){return(0,i.compareSync)(this._password,e)}}},20:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(972)),s=n(96);t.default=class{constructor(e){const{email:t,password:n}=e.body;if(!t)throw new o.default("emailを入力してください",422);if(!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(t))throw new o.default("emailはメールアドレス形式で入力してください",422);if(!n)throw new o.default("passwordを入力してください",422);if(n.length<3||n.length>255)throw new o.default("passwordは3文字以上255文字以下で入力してください",422);if(!/^[A-Za-z0-9]*$/.test(n))throw new o.default("passwordは英数字のみが使用できます",422);this._email=t,this._password=n}get email(){return this._email}get password(){return(0,s.hashSync)(this._password,10)}}},341:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,n,i){this.id=e,this.email=t,this.password=n,this.lineId=i}}},675:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function u(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,u)}a((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UsersDB=void 0;const s=n(690),r=o(n(972));!function(e){e.select=e=>i(this,void 0,void 0,(function*(){return yield s.Users.findAll({where:e})})),e.update=(e,t)=>i(this,void 0,void 0,(function*(){const n=yield s.Users.findOne({where:e});if(!n)throw new r.default("Users Not Found",404);return t.email&&(n.email=t.email),t.password&&(n.password=t.password),t.line_id&&(n.line_id=t.line_id),yield n.save()})),e.insert=e=>i(this,void 0,void 0,(function*(){if(!e.email||!e.password)throw new r.default("Argments Not Enough",404);const t={id:e.id,email:e.email,password:e.password,line_id:e.line_id},[n,i]=yield s.Users.findOrCreate({where:{email:e.email},defaults:t});if(!i)throw new r.default("Failed Insert Data",404);return n})),e.destroy=e=>i(this,void 0,void 0,(function*(){const t=yield s.Users.findOne({where:e});if(!t)throw new r.default("Users not Found",404);return yield t.destroy().catch((()=>{throw new r.default("Failed Delete Data",404)})),!0})),e.count=e=>i(this,void 0,void 0,(function*(){return yield s.Users.count({where:{email:e}})})),e.register=(t,n)=>i(this,void 0,void 0,(function*(){return yield e.insert({email:t,password:n})})),e.fetchByEmail=t=>i(this,void 0,void 0,(function*(){let n=yield e.select({email:t});if(!n)throw new r.default("user not found",404);return n})),e.updateByEmail=(t,n,o)=>i(this,void 0,void 0,(function*(){let i=yield e.update({id:t,email:n},o);if(!i)throw new r.default("user not found",404);return o.email&&(i.email=o.email),o.password&&(i.password=o.password),o.line_id&&(i.line_id=o.line_id),yield i.save()}))}(t.UsersDB||(t.UsersDB={}))},563:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(534));t.default=e=>{const t=e.Router(),n=(0,o.default)();return t.route("/").post(n.signup),t.route("/login").post(n.login),t}},540:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function u(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,u)}a((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(n(972)),r=o(n(341)),u=n(675);t.default=()=>({signup:e=>i(void 0,void 0,void 0,(function*(){if((yield u.UsersDB.count(e.email))>=1)throw new s.default("そのメールアドレスはすでに登録されています",400);const t=yield u.UsersDB.register(e.email,e.password);return new r.default(t.id,t.email)})),login:e=>i(void 0,void 0,void 0,(function*(){const t=(yield u.UsersDB.fetchByEmail(e.email))[0];if(!e.comparePassword(t.password))throw new s.default("メールアドレスまたはパスワードが間違っています",401);return new r.default(t.id,e.email)}))})},280:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0});const i={server:{port:null!==(n=process.env.PORT)&&void 0!==n?n:3001,cors:{origin:"http://localhost:3000"}}};t.default=i},323:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(762),s=i(n(280)).default.server.port;o.listen(s,(()=>{console.info(`Listening at http://localhost:${s}`)}))},492:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Places=void 0;const o=n(496),s=i(n(332)),r=n(690);class u extends o.Model{}t.Places=u,u.init({id:{type:o.DataTypes.INTEGER,primaryKey:!0,autoIncrement:!0,allowNull:!1},user_id:{type:o.DataTypes.INTEGER,allowNull:!1},name:{type:o.DataTypes.STRING,allowNull:!1}},{tableName:"places",sequelize:s.default,freezeTableName:!0,timestamps:!1}),u.belongsTo(r.Users,{foreignKey:"user_id"})},690:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Users=void 0;const o=n(496),s=i(n(332));class r extends o.Model{}t.Users=r,r.init({id:{type:o.DataTypes.INTEGER,primaryKey:!0,autoIncrement:!0,unique:!0,allowNull:!1},email:{type:o.DataTypes.STRING,unique:!0,allowNull:!1},password:{type:o.DataTypes.STRING,allowNull:!1},line_id:{type:o.DataTypes.INTEGER,allowNull:!0,defaultValue:null}},{tableName:"users",sequelize:s.default,freezeTableName:!0,timestamps:!1})},332:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=new(n(496).Sequelize)("myapp","user","password",{host:"mysql",dialect:"mysql"});i.authenticate().then((()=>{console.log("Success test connection")})).catch((e=>{console.log("Failure test connection",e)})),t.default=i},972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e,t=500){super(e),this.message=e,this.status=t}}t.default=n},965:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{error(e){return{message:e.message}}}},785:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.verifyToken=t.signToken=void 0;const o=i(n(344)),s=null!=="secret_key"?"secret_key":"my SECRET_KEY";t.signToken=e=>o.default.sign(e,s),t.verifyToken=e=>o.default.verify(e,s)},231:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toCamelCaseObject=t.toCamelCase=t.hasProperty=void 0,t.hasProperty=(e,...t)=>e instanceof Object&&t.every((t=>t in e)),t.toCamelCase=e=>e.split("_").map(((e,t)=>0===t?e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(""),t.toCamelCaseObject=e=>{if(Array.isArray(e)){const n=[];return e.forEach((e=>{n.push((0,t.toCamelCaseObject)(e))})),n}{const n={};return Object.keys(e).forEach((i=>{n[(0,t.toCamelCase)(i)]=e[i]})),n}}},697:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(965));t.default=e=>{e.use(((e,t,n,i)=>{const s=e.status||500,r=new o.default;n.status(s).send(r.error(e))}))}},267:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.tokenVerify=void 0;const o=i(n(972)),s=n(785),r=n(231);t.tokenVerify=(e,t,n)=>{const i=e.headers.authorization;if(null==i)throw new o.default("Authorizationリクエストヘッダーがありません。",401);if("Bearer"!==i.split(" ")[0])throw new o.default("Authorizationリクエストヘッダーがありません。",401);const u=i.split(" ")[1];try{const t=(0,s.verifyToken)(u);if(!(0,r.hasProperty)(t,"id")||"number"!=typeof t.id)throw new o.default("トークンが間違っています",401);e.user={id:t.id},n()}catch(e){throw new o.default("認証に失敗しました。",401)}},t.default=t.tokenVerify},762:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(860)),s=i(n(582)),r=i(n(280)),u=i(n(563)),a=i(n(335)),l=i(n(697)),d=i(n(937)),c=(0,o.default)();c.use(o.default.json()),c.use(o.default.urlencoded({extended:!1}));const f={origin:r.default.server.cors.origin,optionsSuccessStatus:200};c.use((0,s.default)(f)),c.use("/api/v1/users",(0,u.default)(o.default)),c.use("/api/v1/foods",(0,d.default)(o.default)),c.use("/api/v1/foods",(0,a.default)(o.default)),(0,l.default)(c),e.exports=c},96:e=>{e.exports=require("bcrypt")},582:e=>{e.exports=require("cors")},860:e=>{e.exports=require("express")},344:e=>{e.exports=require("jsonwebtoken")},496:e=>{e.exports=require("sequelize")}},t={};!function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}(323)})();